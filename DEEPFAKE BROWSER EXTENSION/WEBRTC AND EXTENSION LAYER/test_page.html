<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>DeepfakeGuard Test Page</title>
    <style>body{font-family:Arial, sans-serif;padding:20px}</style>
  </head>
  <body>
    <h3>Test Video</h3>
    <video id="preview" width="480" height="270" controls loop crossorigin="anonymous">
      <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4">
    </video>
    <div style="margin-top:12px">
      <button id="sendFrame">Send Frame to Extension</button>
    </div>

    <script>
      const btn = document.getElementById('sendFrame');
      const v = document.getElementById('preview');
      btn.addEventListener('click', () => {
        try {
          const c = document.createElement('canvas');
          c.width = v.videoWidth || 480; c.height = v.videoHeight || 270;
          const ctx = c.getContext('2d');
          ctx.drawImage(v, 0, 0, c.width, c.height);
          const data = c.toDataURL('image/jpeg', 0.8);
          window.postMessage({ type: 'deepfake_frame', image: data, vidId: 'test-page-1' }, '*');
          alert('Frame posted to window; content script should forward it.');
        } catch (e) { alert('Error capturing frame: ' + e); }
      });
    </script>
  </body>
</html>
